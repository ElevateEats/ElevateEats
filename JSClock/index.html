<!DOCTYPE html>
<html lang="'en">
    <head>
        <meta charset="UTF-8">
        <title>JS + CSS Clock - Rashidi A</title>
        <link rel="icon" href="https://fav.farm/ðŸ˜Ž" />
        <link href="./style.css" rel="stylesheet">
    </head>

    <body>
        <h1>What time is it?</h1>
        <form class="search-form">
            <input type="text" class="search" placeholder="Location">
            <ul class="suggestions"></ul>
        </form>
        <div class="clock">
            <div class="clock-face">
                <div class="hand hour-hand"></div>
                <div class="hand min-hand"></div>
                <div class="hand second-hand" style="transform: rotate(330deg);"
                ></div>
            </div>
            <div>
                <ul>
                    <li>1</li>
                    <li>2</li>
                    <li>3</li>
                    <li>4</li>
                    <li>5</li>
                    <li>6</li>
                    <li>7</li>
                    <li>8</li>
                    <li>9</li>
                    <li>10</li>
                    <li>11</li>
                    <li>12</li>
                </ul>
            </div>
        </div>
        <script>
            const secondHand = document.querySelector('.second-hand');
            const minHand = document.querySelector('.min-hand');
            const hourHand = document.querySelector('.hour-hand');

            function setDate(){
                const now = new Date();

                const seconds = now.getSeconds();
                const secondsDegress = ((seconds / 60) * 360) + 90;
                secondHand.style.transform = `rotate(${secondsDegress}deg)`;

                const mins = now.getMinutes();
                const minsDegrees = ((mins / 60) * 360) + 90;
                minHand.style.transform =  `rotate(${minsDegrees}deg)`;

                const hours = now.getHours();
                const hoursDegrees = ((hours / 12) * 360) + 90;
                hourHand.style.transform = `rotate(${hoursDegrees}deg)`;
                console.log(seconds,mins,hours);
            }
            setInterval(setDate, 1000);

            const endpoint = 'https://gist.githubusercontent.com/Miserlou/c5cd8364bf9b2420bb29/raw/2bf258763cdddd704f8ffd3ea9a3e81d25e2c6f6/cities.json';

            const cities = [];

            fetch(endpoint)
                .then(blob => blob.json())
                .then(data => cities.push(...data))

            function findMatches(word, cities){
                return cities.filter(place => {
                    const regex = new RegExp(word, 'gi');
                    return place.city.match(regex) || place.state.match(regex);
                });
            }

            function numWithCommas(x){
                return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
            }

            function displayMatches(){
                const matchArray = findMatches(this.value, cities);
                const html = matchArray.map(place => {
                    const regex = new RegExp(this.value, 'gi');
                    const cityName = place.city.replace(regex, `<span class="hl">${this.value}</span>`);
                    const stateName = place.state.replace(regex, `<span class="hl">${this.value}</span>`);
                    return `
                        <li>
                            <span class="name">${cityName}, ${stateName}</span>
                        </li>
                    `;
                }).join('');
                suggestions.innerHTML = html;
            }

            const searchInput = document.querySelector('.search');
            const suggestions = document.querySelector('.suggestions');

            searchInput.addEventListener('change', displayMatches);
            searchInput.addEventListener('keyup', displayMatches);
            if(suggestions.childElementCount > 2){
                searchInput.removeEventListener('change', displayMatches);
                searchInput.removeEventListener('keyup', displayMatches);
            }
        </script>
        
    </body>
</html>